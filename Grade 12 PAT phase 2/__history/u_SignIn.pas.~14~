unit u_SignIn;

interface

uses
  u_passwordhasher, dm_CO2,Dialogs,Forms ;

type
  SignIn = class(tObject)
  private
    fFirst_name: string;
    flast_name: string;
    fUsername: String;
    fPassword: string;
    fAttempts: integer;
  public
    procedure SetLogin(sUsername, sPassword: string);
    Function PasswordCheck: boolean;
  end;

implementation

{ SignIn }

function SignIn.PasswordCheck: boolean;
begin
  if fAttempts <= 3 then
  begin
    with dmCO2 do
    begin
      ADOUsers.first;
      while not ADOUsers.eof do
      begin
        if (fUsername = ADOUsers['Username']) and
          (hash(fPassword) = ADOUsers['Password']) then
          result := true

        else
          ADOUsers.Next;
      end;
      // while dmCO2.tblUser.Eof do
      result:=false;
      inc(fAttempts);
      showmessage('Please check your password and username');
      exit;
    end;

  end
else
MessageDlg('Maxmium number of attempts reached. Terminating program.', mterror
      [mbOk], 0, mbOk);
      application.Terminate;

  end;

  procedure SignIn.SetLogin(sUsername, sPassword: string);
  begin
    fUsername := sUsername;
    fPassword := sPassword;
  end;

end.
